<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Helpdesk IDM Kebonrejo v3</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script defer src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
  <script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script defer src="script.js"></script>
</head>
<body>
  <header class="site-header">
    <div class="container">
      <h1>Helpdesk IDM Kebonrejo <span class="tag">v3 (Versi Ringan 6 Dimensi)</span></h1>
      <p>Form offline penggalian data IDM 2025 — Desa Kebon Rejo, Kec. Kepung, Kab. Kediri</p>
    </div>
  </header>

  <main class="container">
    <section class="card">
      <h2>Identitas Responden / Rumah Tangga</h2>
      <form id="idmForm" novalidate>
        <div class="grid-2">
          <label>RT/RW
            <input type="text" name="rt_rw" placeholder="contoh: 02/04" required />
            <span class="err"></span>
          </label>
          <label>Dusun
            <input type="text" name="dusun" placeholder="Nama dusun" required />
            <span class="err"></span>
          </label>
        </div>

        <div class="grid-3">
          <label>Nama Kepala Keluarga
            <input type="text" name="nama_kk" required />
            <span class="err"></span>
          </label>
          <label>NIK (opsional)
            <input type="text" name="nik" pattern="\d{16}" placeholder="16 digit" />
            <span class="err"></span>
          </label>
          <label>Jumlah Anggota Keluarga
            <input type="number" name="jml_anggota" min="1" required />
            <span class="err"></span>
          </label>
        </div>

        <div class="grid-3">
          <label>No. HP (opsional)
            <input type="tel" name="hp" />
            <span class="err"></span>
          </label>
          <label>Nama Berkas Foto (opsional)
            <input type="text" name="foto_rumah" placeholder="mis: IMG_1234.jpg" />
            <span class="err"></span>
          </label>
          <label>Tanggal Pendataan
            <input type="date" name="tgl" />
            <span class="err"></span>
          </label>
        </div>

        <fieldset>
          <legend>Lokasi (GPS)</legend>
          <div class="grid-3">
            <label>Latitude
              <input type="text" name="lat" id="lat" readonly />
            </label>
            <label>Longitude
              <input type="text" name="lng" id="lng" readonly />
            </label>
            <label>Akurasi (meter)
              <input type="text" name="acc" id="acc" readonly />
            </label>
          </div>
          <div class="row">
            <button type="button" id="btnGPS">Ambil Koordinat</button>
            <small class="muted">Jika GPS ditolak, isi manual pada kolom di atas.</small>
          </div>
          <div id="mapWrap">
            <div id="map"></div>
            <small class="muted">Peta membutuhkan internet. Aplikasi tetap dapat digunakan tanpa peta.</small>
          </div>
        </fieldset>

        <hr/>

        <h2>Dimensi 1 — Layanan Dasar (0–100)</h2>
        <div class="grid-4">
          <label>% akses air minum layak
            <input type="number" name="ld_air" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>% akses sanitasi layak
            <input type="number" name="ld_sanitasi" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>% rumah berlistrik
            <input type="number" name="ld_listrik" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>% anak 7–18 bersekolah
            <input type="number" name="ld_sekolah" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>% kepesertaan JKN/KIS
            <input type="number" name="ld_jkn" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
        </div>

        <h2>Dimensi 2 — Sosial (0–100)</h2>
        <div class="grid-4">
          <label>Indeks gotong royong
            <input type="number" name="sos_gotong" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>% partisipasi musdes
            <input type="number" name="sos_musdes" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>Keamanan lingkungan
            <input type="number" name="sos_keamanan" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>Aktivitas budaya/komunitas
            <input type="number" name="sos_budaya" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
        </div>

        <h2>Dimensi 3 — Ekonomi (0–100)</h2>
        <div class="grid-4">
          <label>Keragaman usaha/komoditas
            <input type="number" name="eko_keragaman" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>Akses pasar & logistik
            <input type="number" name="eko_pasar" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>% memiliki rekening/keuangan formal
            <input type="number" name="eko_keuangan" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
        </div>

        <h2>Dimensi 4 — Lingkungan/Ekologi (0–100)</h2>
        <div class="grid-4">
          <label>Pengelolaan sampah
            <input type="number" name="ling_sampah" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>Pengolahan air limbah domestik
            <input type="number" name="ling_airlimbah" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>Ruang terbuka hijau/vegetasi
            <input type="number" name="ling_rth" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>Kesiapsiagaan bencana
            <input type="number" name="ling_kesiap" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
        </div>

        <h2>Dimensi 5 — Aksesibilitas (0–100)</h2>
        <div class="grid-4">
          <label>Akses ke SD/MI
            <input type="number" name="aks_sd" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>Akses ke Puskesmas
            <input type="number" name="aks_puskesmas" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>Akses ke Pasar
            <input type="number" name="aks_pasar" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>Akses ke Kantor Desa
            <input type="number" name="aks_kantor" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
        </div>

        <h2>Dimensi 6 — Tata Kelola Pemerintahan Desa (0–100)</h2>
        <div class="grid-4">
          <label>Transparansi APBDes
            <input type="number" name="tg_transparansi" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>Pelaksanaan Musrenbang
            <input type="number" name="tg_musrenbang" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>Dokumen RKPDes
            <input type="number" name="tg_rkpdes" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
          <label>Perdes (aturan desa) aktif
            <input type="number" name="tg_perdes" min="0" max="100" placeholder="0–100" />
            <span class="err"></span>
          </label>
        </div>

        <div class="actions">
          <button type="button" id="btnAdd">Tambahkan ke Tabel</button>
          <button type="reset" class="secondary">Reset Form</button>
        </div>
      </form>
    </section>

    <section class="card">
      <h2>Data Terkumpul</h2>
      <div class="table-scroll">
        <table id="dataTable">
          <thead></thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="actions">
        <button id="btnDownload">Download Excel</button>
        <button id="btnClear" class="danger">Hapus Semua Data</button>
      </div>
      <small class="muted">Data sementara disimpan di peramban (localStorage) sampai Anda menghapusnya atau menutup tab.</small>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <small>© 2025 Pemerintah Desa Kebon Rejo, Kec. Kepung, Kab. Kediri — Helpdesk IDM Kebonrejo v3 (Offline)</small>
    </div>
  </footer>
</body>
</html>
